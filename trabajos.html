<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trabajos - SEGURAL</title>

    <style>
        body {
            font-family: Arial, sans-serif;
            background: #0f1e4a;
            color: white;
            margin: 0;
            padding: 20px;
        }

        h1 {
            text-align: center;
            margin-bottom: 20px;
        }

        form {
            max-width: 500px;
            margin: auto;
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 12px;
        }

        label {
            display: block;
            margin-top: 12px;
        }

        input, select {
            width: 100%;
            padding: 10px;
            margin-top: 5px;
            border-radius: 6px;
            border: none;
        }

        button {
            margin-top: 20px;
            width: 100%;
            padding: 12px;
            font-size: 16px;
            font-weight: bold;
            background: white;
            color: #0f1e4a;
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }

        .volver {
            text-align: center;
            margin-top: 20px;
        }

        .volver a {
            color: white;
            text-decoration: underline;
        }
    </style>
</head>
<body>

<h1>ðŸ§° Nuevo Trabajo</h1>

<form id="formTrabajo">
    <label>Trabajos realizados</label>
    <input type="text" id="descripcion" placeholder="Detalle del trabajo" required>

    <label>Cliente</label>
    <input type="text" id="cliente" placeholder="Nombre del cliente" required>

    <label>Ingreso ($)</label>
    <input type="number" id="monto" required>

    <label>Gastos del trabajo ($)</label>
    <input type="number" id="gastos" value="0">

    <label>Fecha</label>
    <input type="date" id="fecha" required>

    <label>Estado</label>
    <select id="estado">
        <option value="Pendiente">Pendiente</option>
        <option value="Finalizado">Finalizado</option>
    </select>

    <button type="submit">ðŸ’¾ Guardar trabajo</button>
</form>

<div class="volver">
    <a href="index.html">â¬… Volver al inicio</a>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
    apiKey: "AIzaSyB44Lxe4w7xrHkz9dQZ4y8I6W_QnRbNxuU",
    authDomain: "segural.firebaseapp.com",
    projectId: "segural",
    storageBucket: "segural.firebasestorage.app",
    messagingSenderId: "446640175127",
    appId: "1:446640175127:web:479a11474a70be0d604452"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const formTrabajo = document.getElementById("formTrabajo");

// Guardar trabajo en Firestore
formTrabajo.addEventListener("submit", async (e) => {
    e.preventDefault();

    const descripcion = document.getElementById("descripcion").value;
    const cliente = document.getElementById("cliente").value;
    const monto = Number(document.getElementById("monto").value);
    const gastos = Number(document.getElementById("gastos").value);
    const fecha = document.getElementById("fecha").value;
    const estado = document.getElementById("estado").value;

    try {
        await addDoc(collection(db, "trabajos"), {
            descripcion,
            cliente,
            monto,
            gastos,
            fecha,
            estado
        });

        alert("Trabajo guardado correctamente âœ”");
        formTrabajo.reset();
    } catch (err) {
        alert("Error guardando trabajo: " + err.message);
    }
});

// Cargar trabajos (opcional, si querÃ©s mostrar lista)
async function cargarTrabajos() {
    const trabajosSnapshot = await getDocs(collection(db, "trabajos"));
    trabajosSnapshot.forEach(doc => {
        console.log(doc.id, doc.data()); // puedes usar esto para mostrar lista si quieres
    });
}

cargarTrabajos();
</script>

</body>
</html>
